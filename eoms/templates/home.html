{% extends "index.html" %}
{% block title %}Home{% endblock %}
{% block css %}<link rel="stylesheet" href="../../static/css/visitor/home.css">{% endblock %}

{% block content %}
<!-- Hero Carousel -->
<section>
  <div id="heroCarousel" class="carousel slide hero-carousel" data-bs-ride="carousel" data-bs-interval="5000">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
      <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
      <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
    </div>
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="..\static\images\homepage\StockCake-Farm Irrigation Equipment_1715503995.jpg" class="d-block w-100" alt="Agricultural Machinery">
        <div class="carousel-caption">
          <h1 class="display-4 fw-bold mb-4">Empowering Your Harvest, Enhancing Your Yield</h1>
          <p class="lead mb-4">Access premium agricultural equipment from trusted local branches</p>
          <button class="hero-btn view-store">Find Your Local Store</button>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://images.unsplash.com/photo-1605000797499-95a51c5269ae?w=1920&h=1080&fit=crop" class="d-block w-100" alt="Farm Irrigation">
        <div class="carousel-caption">
          <h1 class="display-4 fw-bold mb-4">Innovative Tools for Modern Farming</h1>
          <p class="lead mb-4">Rent cutting-edge equipment to boost your agricultural productivity</p>
          <button class="hero-btn" onclick="window.location.href='#equipment'">Browse Equipment</button>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=1920&h=1080&fit=crop" class="d-block w-100" alt="Farm Discussion">
        <div class="carousel-caption">
          <h1 class="display-4 fw-bold mb-4">Expert Support for Every Season</h1>
          <p class="lead mb-4">Get professional guidance and 24/7 rental support</p>
          <button class="hero-btn" onclick="window.location.href='#contact'">Get Support</button>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</section>

<!-- How It Works -->
<section class="container my-5 py-5">
  <div class="text-center mb-5">
    <h2 class="section-title">Just Reserve, Rent and Return</h2>
    <p class="lead text-muted">Simple 3-step process to get the equipment you need</p>
  </div>
  <div class="row g-4">
    {% for step in [
      {'num': '1', 'title': 'Reserve Your Equipment', 'desc': 'Browse our extensive catalog, find the perfect equipment for your needs, and add to cart with just a few clicks.'},
      {'num': '2', 'title': 'Pick Up In Store', 'desc': 'Select your nearest branch location and pick up your equipment. Our staff will ensure everything is ready to go.'},
      {'num': '3', 'title': 'Return Your Equipment', 'desc': 'Bring equipment back to store when done. Easy extension options available if you need more time.'}
    ] %}
    <div class="col-md-4">
      <div class="step-card p-4 h-100 text-center">
        <div class="step-number">{{step.num}}</div>
        <h4 class="fw-bold mb-3">{{step.title}}</h4>
        <p class="text-muted">{{step.desc}}</p>
      </div>
    </div>
    {% endfor %}
  </div>
  <div class="text-center mt-5">
    <button class="hero-btn" onclick="window.location.href='{{ url_for('search_equipment') }}'">Start Renting Now</button>
  </div>
</section>

<!-- Equipment Categories -->
<section class="bg-light py-5" id="equipment">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="section-title">Equipment Categories</h2>
      <p class="lead text-muted">Comprehensive range of agricultural machinery for every farming need</p>
    </div>
    <div class="row g-4">
      {% for cat in [
        {'img': 'Tractorcat.jpg', 'title': 'Tractors', 'desc': 'Heavy-duty tractors for all farming operations', 'code': 'TRAC'},
        {'img': 'Harvester.jpg', 'title': 'Harvesters', 'desc': 'Efficient harvesting equipment for maximum yield', 'code': 'HARV'},
        {'img': 'https://images.unsplash.com/photo-1605000797499-95a51c5269ae?w=400&h=200&fit=crop', 'title': 'Irrigation Systems', 'desc': 'Modern irrigation solutions for optimal water management', 'code': 'IRRSY'},
        {'img': 'https://images.unsplash.com/photo-1625246333195-78d9c38ad449?w=400&h=200&fit=crop', 'title': 'Farm Tools', 'desc': 'Essential tools and implements for daily farm work', 'code': 'FATO'}
      ] %}
      <div class="col-md-3">
        <div class="card category-card h-100">
          <img src="{% if cat.img.startswith('http') %}{{cat.img}}{% else %}..\static\images\homepage\{{cat.img}}{% endif %}" class="card-img-top" alt="{{cat.title}}">
          <div class="card-body text-center">
            <h5 class="card-title fw-bold">{{cat.title}}</h5>
            <p class="card-text text-muted">{{cat.desc}}</p>
            <button class="btn btn-success" onclick="window.location.href='{{ url_for('view_equipment_by_category', category_code=cat.code) }}'">Explore {{cat.title}}</button>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>



<!-- Special Offers -->
<section class="container my-5 py-5">
  <div class="text-center mb-5">
    <h2 class="section-title">Special Offers</h2>
    <p class="lead text-muted">Don't miss out on these amazing deals</p>
  </div>
  <div class="row g-4">
    {% for product in promo_products[:3] %}
    <div class="col-md-4">
      <div class="promo-card position-relative">
        <div class="discount-badge">{{(product.disc_rate)|round(0)}}% OFF</div>
        <div class="row g-0 h-100">
          <div class="col-5">
            <a href="{{ url_for('view_equipment_detail', category_code=product.category_code, product_code=product.product_code) }}">
              <img src="{{ url_for('static', filename='images/product/' ~ product.image) }}" class="promo-image" loading="lazy" alt="{{product.name}}">
            </a>
          </div>
          <div class="col-7 p-3 d-flex flex-column justify-content-between">
            <div>
              <a href="{{ url_for('view_equipment_detail', category_code=product.category_code, product_code=product.product_code) }}" class="text-decoration-none">
                <h5 class="promo-title">{{product.name}}</h5>
              </a>
            </div>
            <div class="mt-auto">
              <p class="promo-code">Use code: {{product.promo_code}}</p>
              <a href="{{ url_for('view_equipment_detail', category_code=product.category_code, product_code=product.product_code) }}" class="btn btn-outline-success btn-sm">View Details</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>

<!-- Popular Equipment -->
<div class="cate-bg py-5">
  <section class="container">
    <div class="text-center py-4">
      <h1 class="section-title-dark">Popular Equipment</h1>
    </div>
    <div class="row g-4">
      {% for product in home_popular_products %}
      <div class="col-lg-3 col-md-4 col-sm-6">
        <a href="{{ url_for('view_equipment_detail', category_code=product.category_code, product_code=product.product_code) }}" class="text-decoration-none">
          <div class="popular-card">
            <div class="popular-image-container">
              <img class="popular-image" loading="lazy" alt="{{product.name}}" src="{{ url_for('static', filename='images/product/' ~ product.image) }}">
            </div>
            <div class="popular-content">
              <h6 class="popular-title">{{product.name}}</h6>
              <small class="popular-code">{{product.product_code}}</small>
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
    <div class="text-center mt-5">
      <button class="btn btn-success btn-lg px-5 cate-button view-equipment">View All Equipment →</button>
    </div>
  </section>
</div>

<!-- Why Choose Us -->
<section class="bg-light py-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="section-title">Why Choose AgriRent?</h2>
      <p class="lead text-muted">Your trusted partner in agricultural equipment rental</p>
    </div>
    <div class="row g-4">
      {% for feature in [
        {'icon': 'fa-tractor', 'title': 'Wide Range of Equipment', 'desc': 'From tractors to precision farming tools – we have everything you need for successful farming operations.'},
        {'icon': 'fa-map-marker-alt', 'title': 'Multiple Locations', 'desc': 'Convenient branches across Chhattisgarh with local support and quick equipment availability.'},
        {'icon': 'fa-clock', 'title': '24/7 Online Booking', 'desc': 'Book equipment anytime through our user-friendly online platform with instant confirmation.'}
      ] %}
      <div class="col-md-4 text-center">
        <div class="feature-icon">
          <i class="fa {{feature.icon}} fa-2x text-white"></i>
        </div>
        <h5 class="fw-bold">{{feature.title}}</h5>
        <p class="text-muted">{{feature.desc}}</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>


<!-- Customer Testimonials -->
<section class="container my-5">
    <h2 class="text-center mb-4 section-title">What Farmers Say</h2>
    <p class="text-center text-muted mb-5">Real experiences from our satisfied customers</p>
    <div class="row">
        {% if testimonials %}
            {% for testimonial in testimonials %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body text-center">
                        <p class="card-text fst-italic">"{{ testimonial.testimonial_text }}"</p>
                        <div class="my-3">
                            {% for i in range(testimonial.rating) %}
                                <i class="fas fa-star text-warning"></i>
                            {% endfor %}
                            {% for i in range(5 - testimonial.rating) %}
                                <i class="far fa-star text-warning"></i>
                            {% endfor %}
                        </div>
                        <h5 class="fw-bold">{{ testimonial.first_name }} {{ testimonial.last_name }}</h5>
                        <p class="text-muted">Verified Customer</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p class="text-center">No testimonials yet. Be the first to share your experience!</p>
        {% endif %}
    </div>
</section>



<!-- Call-to-Action -->
<section class="container">
  <div class="cta-section text-center p-5">
    <h2 class="fw-bold mb-3">Ready to Boost Your Farm Productivity?</h2>
    <p class="lead mb-4">Join thousands of farmers who trust AgriRent for their equipment needs</p>
    <div class="d-flex gap-3 justify-content-center flex-wrap">
      <a href="{{url_for('search_equipment')}}"><button class="btn btn-light btn-lg fw-bold">Browse Equipment</button> </a>
      <a href="{{ url_for('view_stores') }}">
        <button class="btn btn-outline-light btn-lg">Find Nearest Branch</button>
      </a>
    </div>
  </div>
</section>

<style>
.section-title { font-size: 2.5rem; font-weight: 700; color: #2c3e50; margin-bottom: 1rem; }
.section-title-dark { font-size: 2.2rem; font-weight: 700; color: #2c3e50; }
.promo-card { background: white; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease; height: 100%; min-height: 200px; }
.promo-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
.discount-badge { position: absolute; top: 15px; right: 15px; background: linear-gradient(135deg, #ff6b6b, #ee5a52); color: white; padding: 6px 14px; border-radius: 25px; font-size: 0.85rem; font-weight: bold; z-index: 10; box-shadow: 0 3px 10px rgba(238, 90, 82, 0.4); white-space: nowrap; }
.promo-image { width: 100%; height: 200px; object-fit: contain; background-color: #f8f9fa; padding: 15px; transition: transform 0.3s ease; }
.promo-card:hover .promo-image { transform: scale(1.05); }
.promo-title { font-size: 1.1rem; font-weight: bold; color: #2c3e50; line-height: 1.3; margin-bottom: 10px; }
.promo-code { font-size: 0.9rem; font-weight: bold; color: #28a745; margin-bottom: 10px; }
.popular-card { background: white; border-radius: 12px; box-shadow: 0 3px 10px rgba(0,0,0,0.08); overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease; height: 100%; min-height: 250px; }
.popular-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0,0,0,0.15); }
.popular-image-container { height: 160px; background-color: #f8f9fa; display: flex; align-items: center; justify-content: center; padding: 20px; }
.popular-image { width: 100%; height: 100%; object-fit: contain; transition: transform 0.3s ease; }
.popular-card:hover .popular-image { transform: scale(1.08); }
.popular-content { padding: 20px 15px; text-align: center; }
.popular-title { font-size: 1rem; font-weight: 600; color: #2c3e50; margin-bottom: 8px; line-height: 1.3; }
.popular-code { color: #6c757d; font-weight: 500; }
.cate-bg { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); }
@media (max-width: 768px) {
  .promo-image { height: 150px; padding: 10px; }
  .popular-image-container { height: 130px; padding: 15px; }
  .section-title { font-size: 2rem; }
  .section-title-dark { font-size: 1.8rem; }
}
</style>
{% endblock %}

{% block js %}

<script>
function initMap() {
  const locations = [
    { lat: 21.1904, lng: 81.2849, name: "Durg Branch", address: "Main Street, Durg" },
    { lat: 21.1938, lng: 81.3509, name: "Bhilai Branch", address: "Steel City, Bhilai" },
    { lat: 21.2514, lng: 81.6296, name: "Raipur Branch", address: "Capital Complex, Raipur" },
    { lat: 21.8974, lng: 83.3950, name: "Raigarh Branch", address: "Industrial Area, Raigarh" }
  ];

  const map = new google.maps.Map(document.getElementById("map"), {
    zoom: 8,
    center: { lat: 21.2514, lng: 81.6296 },
    styles: [
      { featureType: "all", elementType: "geometry.fill", stylers: [{ color: "#f5f5f5" }] },
      { featureType: "water", elementType: "geometry", stylers: [{ color: "#c9c9c9" }] }
    ]
  });

  locations.forEach(location => {
    const marker = new google.maps.Marker({
      position: { lat: location.lat, lng: location.lng },
      map: map,
      title: location.name,
      icon: {
        url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCAzMCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE1IDQwQzE1IDQwIDMwIDIyLjUgMzAgMTVDMzAgNi43MTU3MyAyMy4yODQzIDAgMTUgMEM2LjcxNTczIDAgMCA2LjcxNTczIDAgMTVDMCAyMi41IDE1IDQwIDE1IDQwWiIgZmlsbD0iIzI4YTc0NSIvPgo8Y2lyY2xlIGN4PSIxNSIgY3k9IjE1IiByPSI4IiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K'
      }
    });

    const infoWindow = new google.maps.InfoWindow({
      content: `<div style="padding: 10px; min-width: 200px;"><h6 style="color: #28a745; margin-bottom: 5px; font-weight: bold;">${location.name}</h6><p style="margin: 0; color: #666;">${location.address}</p><button style="background: #28a745; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-top: 10px;">Visit Branch</button></div>`
    });

    marker.addListener("click", () => {
      infoWindow.open(map, marker);
    });
  });
}

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});

const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -100px 0px' };
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.style.opacity = '1';
      entry.target.style.transform = 'translateY(0)';
    }
  });
}, observerOptions);

document.addEventListener('DOMContentLoaded', () => {
  const cards = document.querySelectorAll('.card, .step-card, .promo-card');
  cards.forEach(card => {
    card.style.opacity = '0';
    card.style.transform = 'translateY(30px)';
    card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
    observer.observe(card);
  });
});

$(document).ready(function() {
  $('.view-store').on('click', function() {
    window.location.href = "{{url_for('view_stores')}}";
  });
  $('.view-equipment').on('click', function() {
    window.location.href = "{{url_for('search_equipment')}}";
  });
});
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap"></script>
{% endblock %}